---
import Check from "@/icons/Check.astro";

const tiers = [
  {
    name: "Single class",
    price: { shorter: 19.99, longer: 199.99 },
    description:
      "Get access to a single class. Perfect for those who want to try out a class before committing.",
    features: ["Access to all classes", "Cancel anytime", "Priority support"],
  },
  {
    name: "5 classes",
    price: { shorter: 24.99, longer: 249.99 },
    description:
      "Save 20% with this bundle of 5 classes. Perfect for those who want to try out a few classes.",
    features: [
      "Access to all classes",
      "Cancel anytime",
      "Priority support",
      "Save 20%",
    ],
    popular: true,
  },
  {
    name: "10 classes",
    price: { shorter: 39.99, longer: 399.99 },
    description:
      "Save 40% with this bundle of 10 classes. Perfect for those who want to commit to their practice.",
    features: [
      "Access to all classes",
      "Cancel anytime",
      "Priority support",
      "Save 40%",
      "Free yoga mat",
    ],
  },
];
---

<section class="2xl:container px-4 md:px-8 py-8 md:py-12">
  <h2 class="text-5xl text-cyan-800 md:col-span-2 text-center">PRICING</h2>
  <!-- Classes duration -->
  <div class="flex justify-center mt-16">
    <fieldset
      id="duration-toggle"
      class="w-48 grid grid-cols-2 gap-x-1 rounded-full p-1 text-center text-xs font-semibold leading-5 ring-1 ring-inset ring-gray-200"
    >
      <legend class="sr-only">Classes duration</legend>
      <input
        type="radio"
        id="shorter"
        name="duration"
        value="shorter"
        class="sr-only peer/shorter"
        checked
      />
      <label
        for="shorter"
        class="select-none cursor-pointer rounded-full px-2.5 py-1 peer-checked/shorter:bg-cyan-800 peer-checked/shorter:text-white text-gray-500"
      >
        <span>30 minutes</span>
      </label>
      <input
        type="radio"
        id="longer"
        name="duration"
        value="longer"
        class="sr-only peer/longer"
      />
      <label
        for="longer"
        class="select-none cursor-pointer rounded-full px-2.5 py-1 peer-checked/longer:bg-cyan-800 peer-checked/longer:text-white text-gray-500"
      >
        <span>50 minutes</span>
      </label>
    </fieldset>
  </div>

  <!-- Tiers -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 sm:gap-8 mt-10">
    {
      tiers.map((tier) => (
        <div
          class={`shadow-lg rounded-xl p-8 ${
            tier.popular ? "border-2 border-cyan-800" : "border border-gray-200"
          }`}
        >
          <div class="flex justify-between items-center">
            <h3
              class={`
                    font-bold text-xl
                    ${tier.popular && "text-cyan-800"}
                    `}
            >
              {tier.name}
            </h3>
            {tier.popular && (
              <span class="text-white text-sm font-bold bg-[#85CBCC] px-3 py-1 rounded-full">
                Most popular
              </span>
            )}
          </div>
          <p class="text-gray-600 text-sm mt-4">{tier.description}</p>
          <p class="mt-6">
            <span
              class="text-gray-900 text-4xl font-bold"
              data-price
              data-price-shorter={`${tier.price.shorter}`}
              data-price-longer={`${tier.price.longer}`}
            >
              ${tier.price.shorter}
            </span>
            <span class="text-gray-600 text-sm font-semibold">/class</span>
          </p>
          <a
            id="Setmore_button_iframe"
            href="https://booking.setmore.com/scheduleappointment/90f174af-1ae5-468c-8188-4f4eeea19cfa"
            class={`mt-6 shadow-sm rounded-md py-2 px-3 text-center text-sm w-full font-semibold border border-cyan-800 block
                ${tier.popular ? "bg-cyan-800 text-white" : "text-cyan-800 "}
                `}
          >
            Buy class
          </a>
          <ul class="mt-8 space-y-3 text-sm text-gray-600">
            {tier.features.map((benefit) => (
              <li class="flex gap-x-3">
                <span class="text-cyan-800">
                  <Check />
                </span>{" "}
                {benefit}
              </li>
            ))}
          </ul>
        </div>
      ))
    }
  </div>
</section>

<script>
  function togglePrice(duration: "shorter" | "longer") {
    const priceElements = document.querySelectorAll("[data-price]");

    priceElements.forEach((el) => {
      const shorterPrice = el.getAttribute("data-price-shorter");
      const longerPrice = el.getAttribute("data-price-longer");

      el.textContent =
        duration === "shorter" ? `$${shorterPrice}` : `$${longerPrice}`;
    });
  }

  document.addEventListener("DOMContentLoaded", () => {
    const toggle = document.getElementById("duration-toggle");
    toggle.addEventListener("change", (event) => {
      if (event.target.name === "duration") {
        togglePrice(event.target.value);
      }
    });
  });

  // Initial price toggle based on the default checked radio button
  const checkedRadio = document.querySelector(
    'input[name="frequency"]:checked'
  );
  togglePrice(checkedRadio.value);
</script>
